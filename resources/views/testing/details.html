<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE-2025-0247</title>
    <script src="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.js"></script>
    <script src="https://unpkg.com/flowbite@1.6.0/dist/flowbite.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/flowbite@1.6.0/dist/flowbite.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <!-- Header Section -->
        <div class="bg-white shadow rounded p-4 mb-6">
            <h1 class="text-2xl font-bold mb-2">CVE-2025-0247</h1>
            <p class="text-gray-600">Memory safety bugs present in Firefox 133 and Thunderbird 133. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code. This vulnerability affects Firefox &lt; 134 and Thunderbird &lt; 134.</p>
        </div>

        <!-- Metrics Section -->
        <div class="bg-white shadow rounded p-4 mb-6">
            <h2 class="text-xl font-semibold mb-4">Metrics</h2>
            <div class="grid grid-cols-3 gap-4">
                <div class="p-4 border rounded bg-gray-50">
                    <p class="text-sm font-medium">CVSS v3.1</p>
                    <p class="text-xl text-red-600 font-bold">8.8 High</p>
                </div>
                <div class="p-4 border rounded bg-gray-50">
                    <p class="text-sm font-medium">KEV</p>
                    <p class="text-xl font-bold">No</p>
                </div>
                <div class="p-4 border rounded bg-gray-50">
                    <p class="text-sm font-medium">SSVC</p>
                    <p class="text-xl text-green-600 font-bold">Yes</p>
                </div>
            </div>
        </div>

        <!-- Affected Vendors & Products -->
        <div class="bg-white shadow rounded p-4 mb-6">
            <h2 class="text-xl font-semibold mb-4">Affected Vendors & Products</h2>
            <div class="text-gray-500">No data available.</div>
        </div>

        <!-- References Section -->
        <div class="bg-white shadow rounded p-4 mb-6">
            <h2 class="text-xl font-semibold mb-4">References</h2>
            <ul class="list-disc list-inside text-blue-600">
                <li><a href="https://bugzilla.mozilla.org/buglist.cgi?bug_id=1835193%2C1910021%2C1919803%2C1931576%2C1931948%2C1932173" target="_blank" class="hover:underline">Bugzilla Report</a></li>
                <li><a href="https://www.mozilla.org/security/advisories/mfsa2025-01/" target="_blank" class="hover:underline">Mozilla Advisory 1</a></li>
                <li><a href="https://www.mozilla.org/security/advisories/mfsa2025-04/" target="_blank" class="hover:underline">Mozilla Advisory 2</a></li>
            </ul>
        </div>

        <!-- History Section -->
        <div class="bg-white shadow rounded p-4">
            <h2 class="text-xl font-semibold mb-4">History</h2>
            <div class="overflow-auto">
                <table class="w-full border-collapse border border-gray-300">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 p-2">Date</th>
                            <th class="border border-gray-300 p-2">Type</th>
                            <th class="border border-gray-300 p-2">Values Removed</th>
                            <th class="border border-gray-300 p-2">Values Added</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="border border-gray-300 p-2">Thu, 09 Jan 2025 08:45:00 +0000</td>
                            <td class="border border-gray-300 p-2">Update</td>
                            <td class="border border-gray-300 p-2">Memory safety bugs present in Firefox 132 and Thunderbird 132...</td>
                            <td class="@extends('layouts.app')

                            @section('content')
                            <div class="space-y-8">
                                <!-- Stats Overview -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 fade-in">
                                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover-scale">
                                        <h3 class="text-sm font-medium text-slate-500">Total Threat Groups</h3>
                                        <p class="text-2xl font-bold text-slate-800 mt-2">{{ $allThreatGroups->count() }}</p>
                                    </div>
                                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover-scale">
                                        <h3 class="text-sm font-medium text-slate-500">Countries Affected</h3>
                                        <p class="text-2xl font-bold text-slate-800 mt-2">
                                            {{ $allThreatGroups->pluck('country')->flatten()->unique()->count() }}
                                        </p>
                                    </div>
                                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover-scale">
                                        <h3 class="text-sm font-medium text-slate-500">Last Updated</h3>
                                        <p class="text-2xl font-bold text-slate-800 mt-2">
                                            {{ $allThreatGroups->first() ? \Carbon\Carbon::parse($allThreatGroups->first()['last-card-change'])->format('M d, Y') : 'N/A' }}
                                        </p>
                                    </div>
                                </div>

                                <!-- Charts Section -->
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 fade-in" style="animation-delay: 0.2s">
                                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover-scale">
                                        <h2 class="text-lg font-semibold text-slate-800 mb-4">Threat Groups by Country</h2>
                                        <div id="countryChart" class="mt-4"></div>
                                    </div>
                                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover-scale">
                                        <h2 class="text-lg font-semibold text-slate-800 mb-4">Actor Distribution by Source</h2>
                                        <div id="nameGiverChart" class="mt-4"></div>
                                    </div>
                                </div>

                                <!-- Table Section -->
                                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden fade-in" style="animation-delay: 0.4s">
                                    <div class="p-6 border-b border-slate-200">
                                        <h2 class="text-lg font-semibold text-slate-800">Threat Groups Details</h2>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead>
                                                <tr class="bg-slate-50 border-b border-slate-200">
                                                    <th class="px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Name</th>
                                                    <th class="px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Country</th>
                                                    <th class="px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Description</th>
                                                    <th class="px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Last Update</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-slate-200">
                                                @foreach($paginatedThreatGroups as $group)
                                                <tr class="hover:bg-slate-50 transition-colors">
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900">
                                                        {{ $group['actor'] ?? 'Unknown' }}
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">
                                                        @foreach($group['country'] as $country)
                                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 mr-1">
                                                                {{ $country }}
                                                            </span>
                                                        @endforeach
                                                    </td>
                                                    <td class="px-6 py-4 text-sm text-slate-600 max-w-md truncate">
                                                        {{ $group['description'] ?? 'No description available' }}
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">
                                                        {{ \Carbon\Carbon::parse($group['last-card-change'])->format('M d, Y') }}
                                                    </td>
                                                </tr>
                                                @endforeach
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="px-6 py-4 border-t border-slate-200">
                                        {{ $paginatedThreatGroups->links() }}
                                    </div>
                                </div>
                            </div>

                            <script>
                                // Chart Configurations
                                const chartTheme = {
                                    fontFamily: 'Inter, sans-serif',
                                    foreColor: '#475569',
                                };

                                // Convert Laravel collection to JavaScript array
                                const threatGroups = @json($allThreatGroups);

                                // Process data for charts
                                const countries = {};
                                const nameGivers = {};

                                threatGroups.forEach(group => {
                                    // Process countries
                                    if (Array.isArray(group.country)) {
                                        group.country.forEach(country => {
                                            countries[country] = (countries[country] || 0) + 1;
                                        });
                                    }

                                    // Process name givers
                                    if (Array.isArray(group.names)) {
                                        group.names.forEach(name => {
                                            let giver = name["name-giver"] || "Unknown";
                                            if (giver.trim() === "?" || giver.trim() === "") {
                                                giver = "Unknown";
                                            }
                                            nameGivers[giver] = (nameGivers[giver] || 0) + 1;
                                        });
                                    }
                                });

                                // Country Distribution Chart
                                const countryChartOptions = {
                                    chart: {
                                        type: 'donut',
                                        height: 400,
                                        fontFamily: 'Inter, sans-serif',
                                        toolbar: {
                                            show: false
                                        },
                                        animations: {
                                            enabled: true,
                                            easing: 'easeinout',
                                            speed: 800,
                                        }
                                    },
                                    theme: {
                                        mode: 'light',
                                        palette: 'palette4'
                                    },
                                    series: Object.values(countries),
                                    labels: Object.keys(countries),
                                    plotOptions: {
                                        pie: {
                                            donut: {
                                                size: '70%',
                                                labels: {
                                                    show: true,
                                                    total: {
                                                        show: true,
                                                        label: 'Total Groups',
                                                        formatter: function (w) {
                                                            return w.globals.seriesTotals.reduce((a, b) => a + b, 0)
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    dataLabels: {
                                        enabled: false
                                    },
                                    legend: {
                                        position: 'bottom',
                                        horizontalAlign: 'center',
                                        fontSize: '14px',
                                        markers: {
                                            width: 12,
                                            height: 12,
                                            radius: 6
                                        }
                                    },
                                    stroke: {
                                        width: 0
                                    }
                                };

                                // Name Giver Distribution Chart
                                const nameGiverChartOptions = {
                                    chart: {
                                        type: 'bar',
                                        height: 400,
                                        fontFamily: 'Inter, sans-serif',
                                        toolbar: {
                                            show: false
                                        },
                                        animations: {
                                            enabled: true,
                                            easing: 'easeinout',
                                            speed: 800,
                                        }
                                    },
                                    theme: {
                                        mode: 'light',
                                        palette: 'palette4'
                                    },
                                    series: [{
                                        name: 'Actors',
                                        data: Object.values(nameGivers)
                                    }],
                                    xaxis: {
                                        categories: Object.keys(nameGivers),
                                        labels: {
                                            rotate: -45,
                                            trim: true
                                        }
                                    },
                                    plotOptions: {
                                        bar: {
                                            borderRadius: 6,
                                            columnWidth: '60%',
                                            distributed: true
                                        }
                                    },
                                    dataLabels: {
                                        enabled: false
                                    },
                                    legend: {
                                        show: false
                                    },
                                    grid: {
                                        borderColor: '#f1f5f9',
                                        strokeDashArray: 4
                                    }
                                };

                                // Render Charts
                                const countryChart = new ApexCharts(document.querySelector("#countryChart"), countryChartOptions);
                                const nameGiverChart = new ApexCharts(document.querySelector("#nameGiverChart"), nameGiverChartOptions);

                                countryChart.render();
                                nameGiverChart.render();
                            </script>
                            @endsectionborder border-gray-300 p-2">Memory safety bugs present in Firefox 133 and Thunderbird 133...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>
